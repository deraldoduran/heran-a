# heranca

CREATE TABLE IF NOT EXISTS capitais(
  nome VARCHAR(60),
  populacao NUMERIC(10,2),
  altitude INT,
  estado VARCHAR(2)
  );
  
  CREATE TABLE IF NOT EXISTS interior(
    nome VARCHAR(60),
    populacao NUMERIC(10,2),
    altitude INT
    );
    
    INSERT INTO CAPITAIS_ (NOME, POPULACAO, ALTITUDE, ESTADO) VALUES
('FORTALEZA', 500000, 500, 'CE'),
('NATAL', 2000000, 700, 'RN'),
('SÃO PAULO', 500000, 500, 'SP'),
('RIO DE JANEIRO', 250000, 200, 'RJ');

INSERT INTO interior (NOME, POPULACAO, ALTITUDE) VALUES
('QUIXADÁ', 900000, 200),
('QUIXERAMOBIM', 80000, 200),
('SENADOR POMPEU', 20000, 300),
('BANABUIÚ', 10000, 100),
('ACOPIARA', 40000, 1500),
('PIRIPIRI', 15000, 500),
('PINDAMONHAGABA', 300000, 1200),
('CANINDÉ', 500000, 300);

CREATE VIEW todas_as_cidades AS 
SELECT nome, populacao, altitude FROM capitais
UNION
SELECT nome, populacao, altitude FROM interior

SELECT * FROM todas_as_cidades WHERE altitude > 500;

--USANDO HERANÇA
CREATE TABLE IF NOT EXISTS cidades(
    nome VARCHAR(60),
    populacao NUMERIC(10,2),
    altitude INT
    );
    
CREATE TABLE IF NOT EXISTS capitais(
  estado varchar(2)
  )INHERITS (cidades);
  
  --OS INSERTS SÃO IGUAIS
  
    INSERT INTO CAPITAIS_HERANCA (NOME, POPULACAO, ALTITUDE, ESTADO) VALUES
('FORTALEZA', 500000, 500, 'CE'),
('NATAL', 2000000, 700, 'RN'),
('SÃO PAULO', 500000, 500, 'SP'),
('RIO DE JANEIRO', 250000, 200, 'RJ');

INSERT INTO cidades (NOME, POPULACAO, ALTITUDE) VALUES
('QUIXADÁ', 900000, 200),
('QUIXERAMOBIM', 80000, 200),
('SENADOR POMPEU', 20000, 300),
('BANABUIÚ', 10000, 100),
('ACOPIARA', 40000, 1500),
('PIRIPIRI', 15000, 500),
('PINDAMONHAGABA', 300000, 1200),
('CANINDÉ', 500000, 300);

--QUANDO FAZ SELECT DE CICADES JÁ TRAZ A CIDADE E A CAPITAL POIS ESTA TAMBÉM É UMA CIDADE
SELECT * FROM cidades;
--só mostra as cidades
SELECT * FROM ONLY cidades;
